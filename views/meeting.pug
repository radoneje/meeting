extends layout
block head
    link(rel='stylesheet', href='/stylesheets/old.css')
    script(src="/javascripts/utils.js")
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans&display=swap" rel="stylesheet">
    link(rel='stylesheet', href='/stylesheets/login.css')
    link(rel='stylesheet', href='/stylesheets/room.css')
    <script type="text/javascript" src="/lib/adapter.js" ></script>
    <script type="text/javascript" src="/javascripts/wowza.js" ></script>
    <script type="text/javascript" src="/meeting/javascripts/meeting.js" ></script>

    script.
        var meetRoomid= #{meetRoomid};
        var meetid=#{meetRoomid};
        var user=null;
        var eventid=!{eventid};

block content
    div.meetingScreen#app
        div.head
            div.headBox
                div.headLogo
                    <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 100 20" style="enable-background:new 0 0 100 20;" xml:space="preserve">
                    <style type="text/css"> .st0{fill:#EC1C24;} .st1{fill:#ED212E;}</style>
                    <path class="black" d="M35.6,5.3h7.7v2h-5.4v2.1h4.8v2h-4.8v2.1h5.5v2h-7.7V5.3z"/>
                    <path class="black" d="M45.9,5.3h2.5l2.7,7.1l2.7-7.1h2.4L52,15.5h-2L45.9,5.3z"/>
                    <path class="black" d="M59.1,5.3h7.7v2h-5.4v2.1h4.8v2h-4.8v2.1h5.5v2h-7.7V5.3z"/>
                    <path class="black" d="M70.2,5.3h2.1l4.8,6.2V5.3h2.2v10.1h-1.9L72.4,9v6.4h-2.2V5.3z"/>
                    <path class="black" d="M85.5,7.4h-3.1V5.3h8.4v2.1h-3.1v8.1h-2.2V7.4z"/>
                    <path class="black" d="M4.5,10.3C4.5,7.4,6.8,5,9.9,5s5.4,2.3,5.4,5.2c0,2.9-2.3,5.2-5.4,5.2S4.5,13.2,4.5,10.3z M12.9,10.3 c0-1.7-1.3-3.2-3.1-3.2c-1.8,0-3,1.4-3,3.2c0,1.7,1.3,3.2,3.1,3.2S12.9,12,12.9,10.3z"/>
                    <path class="black" d="M17.6,5.2h2.1l4.8,6.2V5.2h2.2v10.1h-1.9l-4.9-6.4v6.4h-2.2V5.2z"/>
                    <path fill="#EC1C24" class="st0" d="M30.6,0.6H1.5C0.8,0.6,0.2,1.2,0.2,2v16.6c0,0.7,0.6,1.3,1.3,1.3h29.1c0.7,0,1.3-0.6,1.3-1.3V2 C31.9,1.2,31.3,0.6,30.6,0.6z M30.5,18.5H1.7V2.1h28.8V18.5z"/>
                    <ellipse fill="#ED212E" class="st1" cx="97" cy="10.3" rx="3" ry="2.9"/>
                    </svg>
                div.headTitle Переговорная комната {{user.i}} {{user.f}}
        div.center
            div.L
                div.Lbody
                    div(v-if="noWebrtc")
                        div Используйте  Chrome
                    div(v-else)
                        div.meetVideoBox#meetVideoBox



                div.meetingBtnBox(v-if="!firstConnect")
                    div
                        div.greenBtn.clearBtn(style="padding: 0 10px;" v-on:click="myVideoBlack()" v-if="!isMyVideoEnabled"  )
                            <svg width="16px" height="10px" viewBox="0 0 16 10" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
                            <!-- Generator: Sketch 51.3 (57544) - http://www.bohemiancoding.com/sketch -->
                            <desc>Created with Sketch.</desc>
                            <defs></defs>
                            <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                            <g id="ic-baseline-videocam" transform="translate(-2.000000, -5.000000)" fill="#ffffff" fill-rule="nonzero">
                            <g id="Icon">
                            <path d="M14.1666667,8.75 L14.1666667,5.83333333 C14.1666667,5.375 13.7916667,5 13.3333333,5 L3.33333333,5 C2.875,5 2.5,5.375 2.5,5.83333333 L2.5,14.1666667 C2.5,14.625 2.875,15 3.33333333,15 L13.3333333,15 C13.7916667,15 14.1666667,14.625 14.1666667,14.1666667 L14.1666667,11.25 L17.5,14.5833333 L17.5,5.41666667 L14.1666667,8.75 Z" id="Icon-Shape"></path>
                            <rect id="Icon-Rectangle-path" fill-opacity="0" x="0" y="0" width="20" height="20"></rect>
                            </g>
                            </g>
                            </g>
                            </svg>
                        div.greenBtn.clearBtn(style="padding: 0 10px; background: red;" v-on:click="myVideoBlack()" v-if="isMyVideoEnabled"  )
                            <svg width="17px" height="17px" viewBox="0 0 17 17" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
                            <!-- Generator: Sketch 51.3 (57544) - http://www.bohemiancoding.com/sketch -->
                            <desc>Created with Sketch.</desc>
                            <defs></defs>
                            <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                            <g id="ic-baseline-videocam-off" transform="translate(-1.000000, -1.000000)" fill="#ffffff" fill-rule="nonzero">
                            <g id="Icon">
                            <path d="M17.5,5.41666667 L14.1666667,8.75 L14.1666667,5.83333333 C14.1666667,5.375 13.7916667,5 13.3333333,5 L8.18333333,5 L17.5,14.3166667 L17.5,5.41666667 Z M2.725,1.66666667 L1.66666667,2.725 L3.94166667,5 L3.33333333,5 C2.875,5 2.5,5.375 2.5,5.83333333 L2.5,14.1666667 C2.5,14.625 2.875,15 3.33333333,15 L13.3333333,15 C13.5083333,15 13.6583333,14.9333333 13.7833333,14.85 L16.4416667,17.5 L17.5,16.4416667 L2.725,1.66666667 Z" id="Icon-Shape"></path>
                            <rect id="Icon-Rectangle-path" fill-opacity="0" x="0" y="0" width="20" height="20"></rect>
                            </g>
                            </g>
                            </g>
                            </svg>
                    div
                        div.greenBtn.clearBtn(style="padding: 0 10px;" v-on:click="myVideoMute()" v-if="!isMyMute"  )
                            <svg width="12px" height="17px" viewBox="0 0 12 17" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
                            <!-- Generator: Sketch 51.3 (57544) - http://www.bohemiancoding.com/sketch -->
                            <desc>Created with Sketch.</desc>
                            <defs></defs>
                            <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                            <g id="Mobile" transform="translate(-152.000000, -501.000000)" fill="#ffffff" fill-rule="nonzero">
                            <g id="ic-baseline-mic" transform="translate(148.000000, 500.000000)">
                            <g id="Icon">
                            <path d="M10,11.6666667 C11.3833333,11.6666667 12.4916667,10.55 12.4916667,9.16666667 L12.5,4.16666667 C12.5,2.78333333 11.3833333,1.66666667 10,1.66666667 C8.61666667,1.66666667 7.5,2.78333333 7.5,4.16666667 L7.5,9.16666667 C7.5,10.55 8.61666667,11.6666667 10,11.6666667 Z M14.4166667,9.16666667 C14.4166667,11.6666667 12.3,13.4166667 10,13.4166667 C7.7,13.4166667 5.58333333,11.6666667 5.58333333,9.16666667 L4.16666667,9.16666667 C4.16666667,12.0083333 6.43333333,14.3583333 9.16666667,14.7666667 L9.16666667,17.5 L10.8333333,17.5 L10.8333333,14.7666667 C13.5666667,14.3666667 15.8333333,12.0166667 15.8333333,9.16666667 L14.4166667,9.16666667 Z" id="Icon-Shape"></path>
                            <rect id="Icon-Rectangle-path" fill-opacity="0" x="0" y="0" width="20" height="20"></rect>
                            </g>
                            </g>
                            </g>
                            </g>
                            </svg>
                        div.greenBtn.clearBtn(style="padding: 0 10px;background: red;" v-on:click="myVideoMute()" v-if="isMyMute"  )
                            <svg width="16px" height="17px" viewBox="0 0 16 17" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
                            <!-- Generator: Sketch 51.3 (57544) - http://www.bohemiancoding.com/sketch -->
                            <desc>Created with Sketch.</desc>
                            <defs></defs>
                            <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                            <g id="Mobile" transform="translate(-150.000000, -418.000000)" fill="#ffffff" fill-rule="nonzero">
                            <g id="ic-baseline-mic-off" transform="translate(148.000000, 417.000000)">
                            <g id="Icon">
                            <path d="M15.8333333,9.16666667 L14.4166667,9.16666667 C14.4166667,9.78333333 14.2833333,10.3583333 14.0583333,10.875 L15.0833333,11.9 C15.55,11.0833333 15.8333333,10.1583333 15.8333333,9.16666667 Z M12.4833333,9.30833333 C12.4833333,9.25833333 12.5,9.21666667 12.5,9.16666667 L12.5,4.16666667 C12.5,2.78333333 11.3833333,1.66666667 10,1.66666667 C8.61666667,1.66666667 7.5,2.78333333 7.5,4.16666667 L7.5,4.31666667 L12.4833333,9.30833333 Z M3.55833333,2.5 L2.5,3.55833333 L7.50833333,8.56666667 L7.50833333,9.16666667 C7.50833333,10.55 8.61666667,11.6666667 10,11.6666667 C10.1833333,11.6666667 10.3666667,11.6416667 10.5416667,11.6 L11.925,12.9833333 C11.3333333,13.2583333 10.675,13.4166667 10,13.4166667 C7.7,13.4166667 5.58333333,11.6666667 5.58333333,9.16666667 L4.16666667,9.16666667 C4.16666667,12.0083333 6.43333333,14.3583333 9.16666667,14.7666667 L9.16666667,17.5 L10.8333333,17.5 L10.8333333,14.7666667 C11.5916667,14.6583333 12.3083333,14.3916667 12.95,14.0166667 L16.4416667,17.5 L17.5,16.4416667 L3.55833333,2.5 Z" id="Icon-Shape"></path>
                            <rect id="Icon-Rectangle-path" fill-opacity="0" x="0" y="0" width="20" height="20"></rect>
                            </g>
                            </g>
                            </g>
                            </g>
                            </svg>
                    div
                        div.greenBtn.clearBtn(style="padding: 0 10px;" v-on:click="showDesktop()" v-if="!isMyDtShow"  )
                            <svg width="20px" height="17px" viewBox="0 0 20 17" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
                            <!-- Generator: Sketch 51.3 (57544) - http://www.bohemiancoding.com/sketch -->
                            <desc>Created with Sketch.</desc>
                            <defs></defs>
                            <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                            <g id="ic-sharp-queue-play-next" transform="translate(0.000000, -2.000000)" fill="#ffffff" fill-rule="nonzero">
                            <g id="Icon">
                            <path d="M19.1666667,2.5 L0.833333333,2.5 L0.833333333,15.8333333 L6.66666667,15.8333333 L6.66666667,17.5 L13.3333333,17.5 L13.3333333,15.8333333 L15,15.8333333 L15,14.1666667 L2.5,14.1666667 L2.5,4.16666667 L17.5,4.16666667 L17.5,10.8333333 L19.1666667,10.8333333 L19.1666667,2.5 Z M10.8333333,8.33333333 L10.8333333,5.83333333 L9.16666667,5.83333333 L9.16666667,8.33333333 L6.66666667,8.33333333 L6.66666667,10 L9.16666667,10 L9.16666667,12.5 L10.8333333,12.5 L10.8333333,10 L13.3333333,10 L13.3333333,8.33333333 L10.8333333,8.33333333 Z M20,15 L16.25,18.75 L15,17.5 L17.5,15 L15,12.5 L16.25,11.25 L20,15 Z" id="Icon-Shape"></path>
                            <rect id="Icon-Rectangle-path" fill-opacity="0" x="0" y="0" width="20" height="20"></rect>
                            </g>
                            </g>
                            </g>
                            </svg>
                        div.greenBtn.clearBtn(style="padding: 0 10px; background: red;" v-on:click="hideDesktop()" v-if="isMyDtShow"  )
                            <svg width="20px" height="16px" viewBox="0 0 20 16" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
                            <!-- Generator: Sketch 51.3 (57544) - http://www.bohemiancoding.com/sketch -->
                            <desc>Created with Sketch.</desc>
                            <defs></defs>
                            <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                            <g id="ic-sharp-remove-from-queue" transform="translate(0.000000, -2.000000)" fill="#ffffff" fill-rule="nonzero">
                            <g id="Icon">
                            <path d="M19.1666667,2.5 L0.833333333,2.5 L0.833333333,15.8333333 L6.66666667,15.8333333 L6.66666667,17.5 L13.3333333,17.5 L13.3333333,15.8333333 L19.1666667,15.8333333 L19.1666667,2.5 Z M17.5,14.1666667 L2.5,14.1666667 L2.5,4.16666667 L17.5,4.16666667 L17.5,14.1666667 Z M13.3333333,8.33333333 L13.3333333,10 L6.66666667,10 L6.66666667,8.33333333 L13.3333333,8.33333333 Z" id="Icon-Shape"></path>
                            <rect id="Icon-Rectangle-path" fill-opacity="0" x="0" y="0" width="20" height="20"></rect>
                            </g>
                            </g>
                            </g>
                            </svg>


            div.R
                div.Rwr
                    div.rContent
                        div.rHead#rHead
                            div.rHeadItem(v-for="item in sect" v-bind:class="{active:item.isActive}" v-on:click="sectActive(item)")
                                div.rHeadItemLogo
                                    img(v-bind:src="item.isActive?item.logoactive:item.logo")
                                div {{item.title}}
                        div.rContentWr(v-if="activeSection==0")
                            div.rBody(id="feedBox" )
                                div.rFeedGroup
                                    div.rFeedGroupTitle Расписание сессий
                                    div.rFeedGroupBody
                                        div.qItem(v-for="item in eventRooms" :id="'eventRoom'+item.id")
                                            div.qItemName {{moment(item.date).format('HH:mm')}} {{item.title}}
                                            div.qItemDate
                                                span.link.green(v-on:click="document.location.href='/room/'+item.id" ) &nbsp;&nbsp; Перейти
                        div.rContentWr(v-if="activeSection==2")
                            div.rBody(id="chatBox" )
                                div.qItem(v-for="item in chat" v-bind:class="{my:(item.userid==user.id)}")
                                    div.qItemSmi  {{item.smi}}
                                    div.qItemName {{item.i}}&nbsp;{{item.f}}
                                    div.qItemText(v-html="item.text")
                                    div(style="text-align:center")
                                        video.qItemVideo(v-bind:src="'/files/'+item.video" v-if="item.video" controls)
                                    div.qItemPhoto(v-on:click="window.open('/files/'+item.photo)" v-bind:style="{backgroundImage:'url(/files/'+item.photo+')'}" v-if="item.photo" controls)
                                    div.qItemDate {{moment(item.date).format("HH:MM")}}
                            div.rFooter
                                div.fileLoadProgress
                                div.askWr
                                    <svg v-on:click="chatFileClick()" style="cursor:pointer" width="14px" height="17px" viewBox="0 0 14 17" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
                                    <!-- Generator: Sketch 51.3 (57544) - http://www.bohemiancoding.com/sketch -->
                                    <desc>Created with Sketch.</desc>
                                    <defs></defs>
                                    <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                                    <g id="Mobile" transform="translate(-99.000000, -201.000000)" fill="#9A9A9A" fill-rule="nonzero">
                                    <g id="ic-sharp-file-upload" transform="translate(94.000000, 198.000000)">
                                    <g id="Icon">
                                    <path d="M9,16 L15,16 L15,10 L19,10 L12,3 L5,10 L9,10 L9,16 Z M5,18 L19,18 L19,20 L5,20 L5,18 Z" id="Icon-Shape"></path>
                                    <rect id="Icon-Rectangle-path" fill-opacity="0" x="0" y="0" width="24" height="24"></rect>
                                    </g>
                                    </g>
                                    </g>
                                    </g>
                                    </svg>
                                    input.ask(v-on:paste="meetchatTextOnPaste($event)" placeholder="Напишите Ваше сообщение" id="chatText" v-model="chatText" v-on:keypress="meetchattextChange($event)")
                                    <svg class="svgSendBtn" v-on:click="meetChattextSend()" width="15px" height="15px" viewBox="0 0 15 15" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
                                        <!-- Generator: Sketch 51.3 (57544) - http://www.bohemiancoding.com/sketch -->
                                        <desc>Created with Sketch.</desc>
                                        <defs></defs>
                                        <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                                        <g id="Desktop-HD" transform="translate(-712.000000, -505.000000)" fill-rule="nonzero">
                                        <g id="ic-baseline-call-made" transform="translate(708.000000, 500.000000)">
                                        <g id="Icon">
                                        <polygon id="Icon-Shape" fill="#9A9A9A" points="9 5 9 7 15.59 7 4 18.59 5.41 20 17 8.41 17 15 19 15 19 5"></polygon>
                                        <rect id="Icon-Rectangle-path" fill-opacity="0" fill="#000000" x="0" y="0" width="24" height="24"></rect>
                                        </g>
                                        </g>
                                        </g>
                                        </g>
                                    </svg>
                        div.rContentWr(v-if="activeSection==3")
                            div.rBody(id="userBox" )
                                div.qItem.userItem(v-for="item in users" v-bind:class="{active:(item.isActive)}")
                                    div.qItemSmi  {{item.title}}
                                    div.qItemName {{item.i}}&nbsp;{{item.f}}
                                    div.userItemAvatar
                                        <svg width="32" height="32" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M15.9993 2.66663C8.77135 2.66663 2.66602 8.77196 2.66602 16C2.66602 23.228 8.77135 29.3333 15.9993 29.3333C23.2274 29.3333 29.3327 23.228 29.3327 16C29.3327 8.77196 23.2274 2.66663 15.9993 2.66663ZM15.9993 9.33329C18.302 9.33329 19.9993 11.0293 19.9993 13.3333C19.9993 15.6373 18.302 17.3333 15.9993 17.3333C13.698 17.3333 11.9993 15.6373 11.9993 13.3333C11.9993 11.0293 13.698 9.33329 15.9993 9.33329ZM9.19135 22.3626C10.3873 20.6026 12.382 19.4293 14.666 19.4293H17.3327C19.618 19.4293 21.6114 20.6026 22.8074 22.3626C21.1034 24.1866 18.686 25.3333 15.9993 25.3333C13.3127 25.3333 10.8953 24.1866 9.19135 22.3626Z" fill="#9A9A9A"/>
                                        </svg>